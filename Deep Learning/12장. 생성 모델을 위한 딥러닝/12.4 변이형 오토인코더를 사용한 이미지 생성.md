이미지를 생성의 고급 개념 2가지
1. 변이형 오토인코더(Variational Auto Encoders, VAE)
2. 생성적 적대 신경망(Generative Adversarial Networks, GAN)

#12.4.1 이미지 잠재 공간에서 샘플링하기
이미지를 생성하는 개념은 각 포인트가 실제와 같은 이미지로 매핑될 수 있는 저차원 잠재공간의 표현을 만드는 것.

잠재 공간의 한 포인트를 입력받아 이미지로 출력하는 모듈을 아래와 같이 부름
-> GAN에서는 생성자(generator)
-> VAE에서는 디코더(decoder)
![[스크린샷 2025-02-13 오전 12.34.54.png]]

![[스크린샷 2025-02-12 오후 2.55.45.png]]

VAE는 구조적으로 잠재 공간을 학습하는데 뛰어나다.
GAN은 매우 실제 같은 이미지를 만든다.

#12.4.2 이미지 변형을 위한 개념 벡터
잠재 공간이나 임베딩 공간이 주어진면 이 공간의 어떤 방향은 원본 데이터의 흥미로운 변화를 인코딩한 축일 수 있다. 예를 들어 얼굴 이미지에 대한 잠재 공간에 웃음 벡터가 있으면 그 벡터를 수정해 이미지를 변화 시킬 수 있다.
![[스크린샷 2025-02-13 오전 9.31.49.png]]

#12.4.3 변이형 오토인코더
변이형 오토인코더는 생성 모델의 한 종류이며 개념 벡터를 사용하여 이미지를 변형시키는데 용의
-> 딥러닝과 베이즈 추론의 아이디어를 혼합해서 만들어졌다.

![[스크린샷 2025-02-13 오전 9.59.36.png]]
입력 이미지를 인코더 해서 잠재 벡터 공간을 매핑 -> 그 후 다시 디코더 모듈을 사용해 원본 이미지를 동일한 차원으로 복원
->but 이런 고전적인 오토인코더는 유용하거나 구조화가 잘된 잠재 공간을 만들지 못함

VAE는 이미지를 어떤 통계 분포의 파라미터로 변환한다. 이건 입력 이미지가 통계적 과정을 통해 생성되었다고 가정하여 인코딩과 디코딩하는 동안 무작위성이 필요하다는 것을 의미

![[스크린샷 2025-02-13 오전 10.01.44.png]]
VAE 동작 방법
1. 인코더 모듈이 입력 샘플 input_img를 잠재 공간의 두 파라미터 z_mean과 z_log_var로 변환합니다.
2. 입력 이미지가 생성되었다고 가정한 잠재 공간의 정규 분포에서 포인트 z를 z = z_mean + exp(0.5 * z_log_var) * epsilon처럼 무작위로 새플링한다. epsilon은 작은 값을 가진 랜덤 텐서이다.
3. 디코더 모듈은 잠재 공간의 이 포인트를 원본 입력 이미지로 매핑하여 복원하다.

VAE는 2개의 손실 함수로 훈련한다.
1. 재구성 손실(reconstruction loss): 디코딩된 샘플이 원본 입력과 동일하도록 만듬
2. 규제 손실(regularization loss): 잠재 공간을 잘 형성하고 훈련 데이터에 과대적합을 줄임
![[스크린샷 2025-02-13 오전 10.43.42.png]]

#12.4.4 케라스로 VAE 구현하기
1. 인코더 네트워크는 실제 이미지를 잠재 공간의 평균과 분산으로 변환한다.
2. 샘플링 층은 이런 평균과 분산을 받아 잠재 공간에서 랜덤한 포인트를 샘플링한다.
3. 디코더 네트워크는 잠재 공간의 포인트를 이미지로 변환한다.

#12.4.4 케라스로 VAE 구현하기
MNIST 숫자를 생성하는 VAE 구현 3가지
1. 인코더 네트워크는 실제 이미지를 잠재 공간의 평균과 분산으로 변환합니다.
2. 샘플링 층은 이런 평균과 분산을 받아 잠재 공간에서 랜덤한 포인트를 샘플링합니다.
3. 디코더 네트워크는 잠재 공간의 포인트를 이미지로 변환합니다.

