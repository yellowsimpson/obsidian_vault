생성적 적대 신경망(GAN)은 VAE와는 다른 방법으로 이미지의 잠재 공간을 학습한다. 

GAN의 네트워크 2개
1. 생성자 네트워크: 랜덤 벡터를 입력으로 받아 이를 합성된 이미지로 디코딩한다.
2. 판별자 네트워크: 이미지를 입력으로 받아 훈련 세트에서 온 이미지인지, 생성자 네트워크가 만든 이미지인지 판별한다.

![[스크린샷 2025-02-13 오후 5.18.36.png]]

#12.5.1 GAN 구현 방법

GAN 구조
1. generator 네트워크는 크기의 벡터(64, 64, 3) 크기의 이미지로 매핑한다.
2. discriminator 네트워크는 (64, 64, 3)크기의 이미지가 진짜일 확률을 추정하여 이진값으로 매핑한다.
3. 생성자와 판별자를 연결하는 gan 네트워크를 만든다. gan(x) = discriminator(generator(x))이다. 이 gan 네트워크는 잠재 공간의 벡터를 판별자의 평가로 매핑한다. 즉, 판별자는 생성자가 잠재 공간의 벡터를 디코딩한 것이 얼마나 현실적인지 평가한다.
4. "진짜/가짜" 레이블과 함께 진짜 이미지와 가짜 이미지 샘플을 사용하여 판별자를 훈련한다.
5. 생성자를 훈련하면 gan 모델의 손실에 대한 생성자 가중치의 그레이디언트를 사용한다. 



#12.5.2 훈련 방법

1. VAE 디코더에서 했던 것처럼 판별자에서 특성 맵을 다운샘플링하는 데 풀링 대신 스트라이드를 사용한다.
2. 균등 분포가 아니고 정규 분포를 사용해서 잠재 공간에서 포인트를 샘플링한다.
3. 무작위성은 모델을 견고하게 만든다. GAN훈련은 동적 평형을 만들기 때문에 여러 방식으로 갇힐 가능성이 높다.
4. 희소한 그레이디언트는 GAN 훈련을 방해할 수 있다. 딥러닝에서는 

![[스크린샷 2025-02-13 오후 6.26.19.png]]

#12.5.3 CelebA 데이터셋 준비하기

#12.5.4 판별자

#12.5.5 생성자

#12.5.6 적대 네트워크

수행 방법
step1
1. 잠재 공간에서 무작위로 포인트를 뽑습니다.
2. 이 랜덤 노이즈를 사용해서 generator에서 이미지를 생성한다.
3. 생성된 이미지와 진짜 이미지를 섞는다.
4. 진짜와 가짜가 섞인 이미지와 이에 대응하는 타깃을 사용해서 discriminator를 훈련한다.
step2
1. 잠재 공간에서 무작위로 새로운 포인트를 뽑는다.
2. 이 랜덤 벡터를 사용해서 generator를 훈련한다. 모든 타킷은 "진짜"로 설정한다. 판별자가 생성된 이미지를 모두 "진짜 이미지"라고 예측하도록 생성자의 가중치를 업데이트한다.
![[스크린샷 2025-02-15 오전 10.45.14.png]]

#12.5.7 정리
1. GAN은 생성자 네트워크와 판별자 네트워크가 연결되어 구성된다. 판별자는 생성자의 출력과 훈련 데이터셋에서 가져온 진짜 이미지를 구분하도록 훈련된다. 생성자는 판별자를 속이도록 훈련된다. 생성자는 훈련 세트의 이미지를 직접보지 않는다. 데이터에 관한 정보는 판별자에서 얻는다.
2. GAN은 훈련하기 어렵다. GAN 훈련이 고정된 손실 공간에서 수행하는 단순한 경사하강법 과정이 아니라 동적 과정이기 때문이다. GAN을 올바르게 훈련하려면 경험적으로 찾은 여러 기교를 사용하고 많은 튜닝을 해야한다.
3. GAN은 실제 같은 이미지를 만들 수 있다. VAE와 달리 학습된 잠재 공간이 깔끔하게 연속된 구조를 가지지 않는다. 잠재 공간의 개념 벡터를 사용해서 이미지를 변형하는 등 실용적인 특정 애플리케이션에 잘 맞지 않는다.

